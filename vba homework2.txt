Sub vbastock()

Range("i1") = "Ticker"
Range("j1") = "Yearly Change"
Range("K1") = "Percent Change"
Range("j1") = "Total Stock Volume"

Range("O2") = "Greatest % increase"
Range("O2") = "Greatest % decrease"
Range("O2") = "Greatest total volume"
Range("p1") = "Ticker"
Range("q1") = "value"


lastrow = ActiveSheet.UsedRange.Rows.Count

totalvolume = 0
tickercount = 0
For i = 2 To lastrow
If Cells(i + 1, 1) <> Cells(i, 1) Then
Cells(tickercount + 2, 9).Value = Cells(i, 1).Value
totalvolume = 0
tickercount = tickercount + 1
openprice = Cells(i - 1, 3).Value
closeprice = Cells(i, 6).Value
Else
totalvolume = totalvolume + Cells(i, 7).Value
Cells(tickercount + 2, 12).Value = totalvolume
End If

On Error GoTo 0
yearlychange = closeprice - openprice
percentage = closeprice / openprice - 1

Cells(tickercount + 2, 10) = yearlychange
Cells(tickercount + 2, 11) = percentage

Next i

End Sub
